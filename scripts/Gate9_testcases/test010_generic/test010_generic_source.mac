# GATE 9 Macro - Generic Source Types Test
# Converted from OpenGATE 10 test010
# Tests multiple source types: sphere, disc, box with different geometries and directions

# =====================================================
# VERBOSE
# =====================================================
/control/verbose 0
/run/verbose 0
/event/verbose 0
/tracking/verbose 0

# =====================================================
# VISUALISATION (disabled)
# =====================================================
#/vis/disable

# =====================================================
# GEOMETRY
# =====================================================

# Material database
/gate/geometry/setMaterialDatabase data/GateMaterials.db

# World
/gate/world/geometry/setXLength 2.0 m
/gate/world/geometry/setYLength 2.0 m
/gate/world/geometry/setZLength 2.0 m
/gate/world/setMaterial Air

# Waterbox
/gate/world/daughters/name waterbox
/gate/world/daughters/insert box
/gate/waterbox/geometry/setXLength 40 cm
/gate/waterbox/geometry/setYLength 40 cm
/gate/waterbox/geometry/setZLength 40 cm
/gate/waterbox/placement/setTranslation 0.0 0.0 0.0 cm
/gate/waterbox/setMaterial Water

# =====================================================
# PHYSICS
# =====================================================
/gate/physics/addPhysicsList QGSP_BERT_EMV

# Production cuts
/gate/physics/Gamma/SetCutInRegion world 1 mm
/gate/physics/Electron/SetCutInRegion world 1 mm
/gate/physics/Positron/SetCutInRegion world 1 mm
/gate/physics/Proton/SetCutInRegion world 1 mm

# =====================================================
# ACTORS
# =====================================================

# Dose Actor
/gate/actor/addActor DoseActor dose
/gate/actor/dose/attachTo waterbox
/gate/actor/dose/stepHitType random
/gate/actor/dose/setResolution 50 50 50
/gate/actor/dose/setVoxelSize 4 4 4 mm
/gate/actor/dose/enableEdep true
/gate/actor/dose/enableDose false
/gate/actor/dose/enableNumberOfHits false
/gate/actor/dose/save test010_generic_source_stat/image.mhd
/gate/actor/dose/saveEveryNSeconds 120

# Simulation Statistics Actor
/gate/actor/addActor SimulationStatisticActor Stats
/gate/actor/Stats/save test010_generic_source_stat/stat.txt
/gate/actor/Stats/saveEveryNSeconds 120

# =====================================================
# INITIALISATION
# =====================================================
/gate/run/initialize

# =====================================================
# SOURCE 1 - Gamma, Spherical source, Mono energy
# =====================================================

/gate/source/addSource source1 gps
/gate/source/source1/gps/particle gamma
/gate/source/source1/gps/ene/mono 1 MeV

# Spherical source volume
/gate/source/source1/gps/pos/type Volume
/gate/source/source1/gps/pos/shape Sphere
/gate/source/source1/gps/pos/radius 5 mm
/gate/source/source1/gps/pos/centre -3 30 -3 cm

# Directional beam along -Y axis
/gate/source/source1/gps/direction 0 -1 0

# Activity
/gate/source/source1/setActivity 10000 Bq

# =====================================================
# SOURCE 2 - Proton, Disc source, Gaussian energy
# =====================================================

/gate/source/addSource source2 gps
/gate/source/source2/gps/particle proton

# Gaussian energy distribution
/gate/source/source2/gps/ene/type Gauss
/gate/source/source2/gps/ene/mono 140 MeV
/gate/source/source2/gps/ene/sigma 10 MeV

# Disc (circular plane) source
/gate/source/source2/gps/pos/type Plane
/gate/source/source2/gps/pos/shape Circle
/gate/source/source2/gps/pos/radius 5 mm
/gate/source/source2/gps/pos/centre 6 5 -30 cm

# No rotation (identity) - disc perpendicular to Z
# Plane normal is default (0, 0, 1)
/gate/source/source2/gps/pos/rot1 1 0 0
/gate/source/source2/gps/pos/rot2 0 1 0

# Direction along +Z axis
/gate/source/source2/gps/direction 0 0 1

# Activity
/gate/source/source2/setActivity 10000 Bq

# =====================================================
# SOURCE 3 - Proton, Box source, Focused direction
# =====================================================

/gate/source/addSource s3 gps
/gate/source/s3/gps/particle proton

# Gaussian energy distribution
/gate/source/s3/gps/ene/type Gauss
/gate/source/s3/gps/ene/mono 140 MeV
/gate/source/s3/gps/ene/sigma 10 MeV

# Box volume source
/gate/source/s3/gps/pos/type Volume
/gate/source/s3/gps/pos/shape Para
/gate/source/s3/gps/pos/halfx 2 cm
/gate/source/s3/gps/pos/halfy 2 cm
/gate/source/s3/gps/pos/halfz 2 cm
/gate/source/s3/gps/pos/centre 8 8 30 cm

# Focused direction towards a point
/gate/source/s3/gps/ang/type focused
/gate/source/s3/gps/ang/focuspoint 1 2 3 cm

# Activity
/gate/source/s3/setActivity 10000 Bq

# =====================================================
# SOURCE 4 - Proton, Box source, Isotropic direction
# =====================================================

/gate/source/addSource s4 gps
/gate/source/s4/gps/particle proton

# Gaussian energy distribution
/gate/source/s4/gps/ene/type Gauss
/gate/source/s4/gps/ene/mono 80 MeV
/gate/source/s4/gps/ene/sigma 1 MeV

# Box volume source
/gate/source/s4/gps/pos/type Volume
/gate/source/s4/gps/pos/shape Para
/gate/source/s4/gps/pos/halfx 2 cm
/gate/source/s4/gps/pos/halfy 2 cm
/gate/source/s4/gps/pos/halfz 2 cm
/gate/source/s4/gps/pos/centre -3 -3 -3 cm

# No rotation (identity)
/gate/source/s4/gps/pos/rot1 1 0 0
/gate/source/s4/gps/pos/rot2 0 1 0

# Isotropic direction (4Ï€)
/gate/source/s4/gps/ang/type iso

# Activity
/gate/source/s4/setActivity 10000 Bq

# =====================================================
# TIMING
# =====================================================

# Single time slice: 0.0 to 1.0 seconds
/gate/application/setTimeStart 0.0 s
/gate/application/setTimeStop 1.0 s

# =====================================================
# START
# =====================================================
/gate/random/setEngineName MersenneTwister
/gate/random/setEngineSeed auto

/gate/application/start